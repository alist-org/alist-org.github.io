import{_ as o}from"./_plugin-vue_export-helper.cdc0426e.js";import{o as i,c as r,a,b as e,e as t,d as s,r as l}from"./app.f75dfb2b.js";const p={},c=t('<h1 id="run-from-source" tabindex="-1"><a class="header-anchor" href="#run-from-source" aria-hidden="true">#</a> Run from source</h1><div class="custom-container danger"><p class="custom-container-title">Warning</p><p>This step is only for users who need to modify the source code by themselves. If you don&#39;t understand, please skip it.</p></div><h3 id="environmental-preparation" tabindex="-1"><a class="header-anchor" href="#environmental-preparation" aria-hidden="true">#</a> Environmental preparation</h3><p>First, you need to have an environment of <code>git</code>, <code>nodejs</code>, <code>pnpm</code>, <code>golang&gt;=1.18</code>, <code>gcc</code></p><h3 id="building-the-front-end" tabindex="-1"><a class="header-anchor" href="#building-the-front-end" aria-hidden="true">#</a> Building the front end</h3>',5),d=s("Clone "),u={href:"https://github.com/alist-org/alist-web",target:"_blank",rel:"noopener noreferrer"},b=s("https://github.com/alist-org/alist-web"),v=s(" this project, execute "),k=a("code",null,"pnpm && pnpm build",-1),h=s(" to get the target file in the dist directory"),g=a("h3",{id:"build-the-backend",tabindex:"-1"},[a("a",{class:"header-anchor",href:"#build-the-backend","aria-hidden":"true"},"#"),s(" Build the backend")],-1),m=s("Clone "),f={href:"https://github.com/alist-org/alist",target:"_blank",rel:"noopener noreferrer"},_=s("https://github.com/alist-org/alist"),q=s(" for this project, copy the "),$=a("code",null,"dist",-1),x=s(" directory of the previous step to the "),y=a("code",null,"public",-1),w=s(" directory under the project, and then:"),V=t(`<div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token assign-left variable">appName</span><span class="token operator">=</span><span class="token string">&quot;alist&quot;</span>
<span class="token assign-left variable">builtAt</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +<span class="token string">&#39;%F %T %z&#39;</span><span class="token variable">)</span></span>&quot;</span>
<span class="token assign-left variable">goVersion</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>go version <span class="token operator">|</span> <span class="token function">sed</span> <span class="token string">&#39;s/go version //&#39;</span><span class="token variable">)</span></span>
<span class="token assign-left variable">gitAuthor</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">git</span> show <span class="token parameter variable">-s</span> <span class="token parameter variable">--format</span><span class="token operator">=</span><span class="token string">&#39;format:%aN &lt;%ae&gt;&#39;</span> HEAD<span class="token variable">)</span></span>
<span class="token assign-left variable">gitCommit</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">git</span> log <span class="token parameter variable">--pretty</span><span class="token operator">=</span>format:<span class="token string">&quot;%h&quot;</span> <span class="token parameter variable">-1</span><span class="token variable">)</span></span>
<span class="token assign-left variable">version</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">git</span> describe <span class="token parameter variable">--long</span> <span class="token parameter variable">--tags</span> <span class="token parameter variable">--dirty</span> <span class="token parameter variable">--always</span><span class="token variable">)</span></span>
<span class="token assign-left variable">webVersion</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">wget</span> -qO- <span class="token parameter variable">-t1</span> <span class="token parameter variable">-T2</span> <span class="token string">&quot;https://api.github.com/repos/alist-org/alist-web/releases/latest&quot;</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">&quot;tag_name&quot;</span> <span class="token operator">|</span> <span class="token function">head</span> <span class="token parameter variable">-n</span> <span class="token number">1</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token parameter variable">-F</span> <span class="token string">&quot;:&quot;</span> <span class="token string">&#39;{print $2}&#39;</span> <span class="token operator">|</span> <span class="token function">sed</span> <span class="token string">&#39;s/\\&quot;//g;s/,//g;s/ //g&#39;</span><span class="token variable">)</span></span>
<span class="token assign-left variable">ldflags</span><span class="token operator">=</span><span class="token string">&quot;\\
-w -s \\
-X &#39;github.com/alist-org/alist/v3/internal/conf.BuiltAt=<span class="token variable">$builtAt</span>&#39; \\
-X &#39;github.com/alist-org/alist/v3/internal/conf.GoVersion=<span class="token variable">$goVersion</span>&#39; \\
-X &#39;github.com/alist-org/alist/v3/internal/conf.GitAuthor=<span class="token variable">$gitAuthor</span>&#39; \\
-X &#39;github.com/alist-org/alist/v3/internal/conf.GitCommit=<span class="token variable">$gitCommit</span>&#39; \\
-X &#39;github.com/alist-org/alist/v3/internal/conf.Version=<span class="token variable">$version</span>&#39; \\
-X &#39;github.com/alist-org/alist/v3/internal/conf.WebVersion=<span class="token variable">$webVersion</span>&#39; \\
&quot;</span>
go build <span class="token parameter variable">-ldflags</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$ldflags</span>&quot;</span> <span class="token builtin class-name">.</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1);function A(B,C){const n=l("ExternalLinkIcon");return i(),r("div",null,[c,a("p",null,[d,a("a",u,[b,e(n)]),v,k,h]),g,a("p",null,[m,a("a",f,[_,e(n)]),q,$,x,y,w]),V])}const E=o(p,[["render",A],["__file","source.html.vue"]]);export{E as default};
