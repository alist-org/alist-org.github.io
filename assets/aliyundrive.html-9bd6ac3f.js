import{c as y,r as s,N as w,a0 as S,Q as e,a2 as o,a1 as c,a4 as p,a5 as u,a6 as f,a3 as _,G as C,_ as E}from"./framework-c1c045a5.js";import{_ as T,a as B}from"./aliyun-da96eadd.js";const N=_('<h1 id="阿里云盘-分享" tabindex="-1"><a class="header-anchor" href="#阿里云盘-分享" aria-hidden="true">#</a> 阿里云盘/分享</h1><div class="hint-container tip"><p class="hint-container-title">提示</p><p>由于阿里云盘 referer 的限制，必须使用移动端 token。 使用桌面 Web 令牌将导致无法下载和预览。 当然，如果你在本地使用或者带宽足够大，你也可以开启代理，让桌面 Web 的 <code>refresh token</code> 正常工作。</p></div><h2 id="刷新令牌" tabindex="-1"><a class="header-anchor" href="#刷新令牌" aria-hidden="true">#</a> 刷新令牌</h2>',3),A={href:"https://github.com/Xhofe/alist/issues/88",target:"_blank",rel:"noopener noreferrer"},D=["disabled"],I={style:{margin:"4px"}},z=["src"],P={href:"http://replit.com",target:"_blank",rel:"noopener noreferrer"},R=e("h2",{id:"root-folder-file-id",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#root-folder-file-id","aria-hidden":"true"},"#"),o(" Root folder file_id")],-1),V=e("p",null,"打开阿里云盘官网，点击进入要设置的文件夹时点击 URL 后面的字符串",-1),j={href:"https://www.aliyundrive.com/drive/folder/5fe01e1830601baf774e4827a9fb8fb2b5bf7940",target:"_blank",rel:"noopener noreferrer"},q=_('<p>这个文件夹的 file_id 即为 <code>5fe01e1830601baf774e4827a9fb8fb2b5bf7940</code>：</p><p><img src="'+T+'" alt="file_id"></p><h2 id="秒传" tabindex="-1"><a class="header-anchor" href="#秒传" aria-hidden="true">#</a> 秒传</h2><p>上传的时候校验hash，如果云端有，直接生成文件，不消耗流量</p><h2 id="内部上传" tabindex="-1"><a class="header-anchor" href="#内部上传" aria-hidden="true">#</a> 内部上传</h2><p>如果你部署 Alist 的服务器是阿里云北京地区ECS，打开此开关可以提升文件上传速度。不符合要求的服务器请不要打开此开关，否则会出现无法上传的问题。</p><h2 id="阿里云盘分享" tabindex="-1"><a class="header-anchor" href="#阿里云盘分享" aria-hidden="true">#</a> 阿里云盘分享</h2><p>主要填写 <strong><a href="#%E5%88%B7%E6%96%B0%E4%BB%A4%E7%89%8C">刷新令牌</a>，分享ID</strong></p><ul><li><p><strong>根文件夹ID</strong>(默认root根目录)，想写就写不想写就是默认根目录</p></li><li><p>分享密码有就写没有就不写</p></li></ul><p><img src="'+B+'" alt="alist"></p>',10),L=y({__name:"aliyundrive.html",setup(O){const n=s("获取 Token"),a=s(0),i=s(""),l=s(""),d=s(""),b=async()=>{n.value="等待...",a.value=1;const t=await(await fetch("https://api.nn.ci/alist/ali/qr")).json();console.log(t),n.value="使用阿里云盘 APP 扫描然后点击",a.value=2,d.value=JSON.stringify({ck:t.content.data.ck,t:t.content.data.t.toString()}),i.value=`https://api.nn.ci/qr/?size=400&text=${encodeURIComponent(t.content.data.codeContent)}`},v=async()=>{a.value=3,n.value="等待...";const t=await(await fetch("https://api.nn.ci/alist/ali/ck",{method:"POST",headers:{"Content-Type":"application/json"},body:d.value})).json(),{content:{data:{qrCodeStatus:r,loginResult:g,bizExt:k}}}=t;if(g!=="success"){a.value=2,n.value="使用阿里云盘 App 扫描然后点击",alert("Status:"+r);return}const x=JSON.parse(atob(k));l.value=x.pds_login_result.refreshToken,n.value="获取 Token 成功",a.value=4,console.log(t)},m=async()=>{a.value===0&&b(),a.value===2&&v()};return(h,t)=>{const r=C("ExternalLinkIcon");return w(),S("div",null,[N,e("p",null,[o("按照这个 "),e("a",A,[o("issue"),c(r)]),o(" 在手机上捕获/查找日志 (/data/media/0/Android/data/com.alicloud.databox/ 文件/日志/跟踪/）。 或者您可以点击：")]),e("p",null,[e("button",{disabled:a.value===3||a.value===1,style:{outline:"none",padding:"12px",background:"#70c6be",border:"none","border-radius":"8px",cursor:"pointer","font-size":"20px"},onClick:m},p(n.value),9,D)]),u(e("div",I,[e("img",{src:i.value},null,8,z)],512),[[f,i.value]]),u(e("div",null," :::info Token: "+p(l.value)+" ::: ",513),[[f,l.value]]),e("p",null,[e("em",null,[o("API is hosted on "),e("a",P,[o("replit.com"),c(r)])])]),R,V,e("p",null,[o("如 "),e("a",j,[o("https://www.aliyundrive.com/drive/folder/5fe01e1830601baf774e4827a9fb8fb2b5bf7940"),c(r)])]),q])}}}),U=E(L,[["__file","aliyundrive.html.vue"]]);export{U as default};
