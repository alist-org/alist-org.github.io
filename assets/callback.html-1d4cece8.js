import{r as R,c as L,a as re,b as m,d as u,e as B,u as Z,f as P,g as se,h as H,i as ie,j as ae,N as le,k as ce,l as de,m as he,n as f,o as pe,p as ue,s as fe,q as ge,t as A,v as me,w as ve,x as be}from"./NaiveConfig-e64120f9.js";import{N as Ce,u as _e}from"./Close-76662e91.js";import{j as n,c as N,h as S,r as ye,a7 as ke,T as $e,b as xe,N as g,O as $,P as z,u as l,a2 as y,a4 as x,Q as v,a8 as T,a0 as j,a1 as M,_ as W,G as ze}from"./framework-b57bf042.js";const Le=R("error",n("svg",{viewBox:"0 0 48 48",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},n("g",{stroke:"none","stroke-width":"1","fill-rule":"evenodd"},n("g",{"fill-rule":"nonzero"},n("path",{d:"M24,4 C35.045695,4 44,12.954305 44,24 C44,35.045695 35.045695,44 24,44 C12.954305,44 4,35.045695 4,24 C4,12.954305 12.954305,4 24,4 Z M17.8838835,16.1161165 L17.7823881,16.0249942 C17.3266086,15.6583353 16.6733914,15.6583353 16.2176119,16.0249942 L16.1161165,16.1161165 L16.0249942,16.2176119 C15.6583353,16.6733914 15.6583353,17.3266086 16.0249942,17.7823881 L16.1161165,17.8838835 L22.233,24 L16.1161165,30.1161165 L16.0249942,30.2176119 C15.6583353,30.6733914 15.6583353,31.3266086 16.0249942,31.7823881 L16.1161165,31.8838835 L16.2176119,31.9750058 C16.6733914,32.3416647 17.3266086,32.3416647 17.7823881,31.9750058 L17.8838835,31.8838835 L24,25.767 L30.1161165,31.8838835 L30.2176119,31.9750058 C30.6733914,32.3416647 31.3266086,32.3416647 31.7823881,31.9750058 L31.8838835,31.8838835 L31.9750058,31.7823881 C32.3416647,31.3266086 32.3416647,30.6733914 31.9750058,30.2176119 L31.8838835,30.1161165 L25.767,24 L31.8838835,17.8838835 L31.9750058,17.7823881 C32.3416647,17.3266086 32.3416647,16.6733914 31.9750058,16.2176119 L31.8838835,16.1161165 L31.7823881,16.0249942 C31.3266086,15.6583353 30.6733914,15.6583353 30.2176119,16.0249942 L30.1161165,16.1161165 L24,22.233 L17.8838835,16.1161165 L17.7823881,16.0249942 L17.8838835,16.1161165 Z"}))))),we=R("info",n("svg",{viewBox:"0 0 28 28",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},n("g",{stroke:"none","stroke-width":"1","fill-rule":"evenodd"},n("g",{"fill-rule":"nonzero"},n("path",{d:"M14,2 C20.6274,2 26,7.37258 26,14 C26,20.6274 20.6274,26 14,26 C7.37258,26 2,20.6274 2,14 C2,7.37258 7.37258,2 14,2 Z M14,11 C13.4477,11 13,11.4477 13,12 L13,12 L13,20 C13,20.5523 13.4477,21 14,21 C14.5523,21 15,20.5523 15,20 L15,20 L15,12 C15,11.4477 14.5523,11 14,11 Z M14,6.75 C13.3096,6.75 12.75,7.30964 12.75,8 C12.75,8.69036 13.3096,9.25 14,9.25 C14.6904,9.25 15.25,8.69036 15.25,8 C15.25,7.30964 14.6904,6.75 14,6.75 Z"}))))),Se=R("success",n("svg",{viewBox:"0 0 48 48",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},n("g",{stroke:"none","stroke-width":"1","fill-rule":"evenodd"},n("g",{"fill-rule":"nonzero"},n("path",{d:"M24,4 C35.045695,4 44,12.954305 44,24 C44,35.045695 35.045695,44 24,44 C12.954305,44 4,35.045695 4,24 C4,12.954305 12.954305,4 24,4 Z M32.6338835,17.6161165 C32.1782718,17.1605048 31.4584514,17.1301307 30.9676119,17.5249942 L30.8661165,17.6161165 L20.75,27.732233 L17.1338835,24.1161165 C16.6457281,23.6279612 15.8542719,23.6279612 15.3661165,24.1161165 C14.9105048,24.5717282 14.8801307,25.2915486 15.2749942,25.7823881 L15.3661165,25.8838835 L19.8661165,30.3838835 C20.3217282,30.8394952 21.0415486,30.8698693 21.5323881,30.4750058 L21.6338835,30.3838835 L32.6338835,19.3838835 C33.1220388,18.8957281 33.1220388,18.1042719 32.6338835,17.6161165 Z"}))))),Ie=R("warning",n("svg",{viewBox:"0 0 24 24",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},n("g",{stroke:"none","stroke-width":"1","fill-rule":"evenodd"},n("g",{"fill-rule":"nonzero"},n("path",{d:"M12,2 C17.523,2 22,6.478 22,12 C22,17.522 17.523,22 12,22 C6.477,22 2,17.522 2,12 C2,6.478 6.477,2 12,2 Z M12.0018002,15.0037242 C11.450254,15.0037242 11.0031376,15.4508407 11.0031376,16.0023869 C11.0031376,16.553933 11.450254,17.0010495 12.0018002,17.0010495 C12.5533463,17.0010495 13.0004628,16.553933 13.0004628,16.0023869 C13.0004628,15.4508407 12.5533463,15.0037242 12.0018002,15.0037242 Z M11.99964,7 C11.4868042,7.00018474 11.0642719,7.38637706 11.0066858,7.8837365 L11,8.00036004 L11.0018003,13.0012393 L11.00857,13.117858 C11.0665141,13.6151758 11.4893244,14.0010638 12.0021602,14.0008793 C12.514996,14.0006946 12.9375283,13.6145023 12.9951144,13.1171428 L13.0018002,13.0005193 L13,7.99964009 L12.9932303,7.8830214 C12.9352861,7.38570354 12.5124758,6.99981552 11.99964,7 Z"}))))),{cubicBezierEaseInOut:_,cubicBezierEaseOut:Te,cubicBezierEaseIn:Be}=re;function Me({overflow:r="hidden",duration:e=".3s",originalTransition:s="",leavingDelay:o="0s",foldPadding:c=!1,enterToProps:a=void 0,leaveToProps:t=void 0,reverse:p=!1}={}){const h=p?"leave":"enter",b=p?"enter":"leave";return[L(`&.fade-in-height-expand-transition-${b}-from,
 &.fade-in-height-expand-transition-${h}-to`,Object.assign(Object.assign({},a),{opacity:1})),L(`&.fade-in-height-expand-transition-${b}-to,
 &.fade-in-height-expand-transition-${h}-from`,Object.assign(Object.assign({},t),{opacity:0,marginTop:"0 !important",marginBottom:"0 !important",paddingTop:c?"0 !important":void 0,paddingBottom:c?"0 !important":void 0})),L(`&.fade-in-height-expand-transition-${b}-active`,`
 overflow: ${r};
 transition:
 max-height ${e} ${_} ${o},
 opacity ${e} ${Te} ${o},
 margin-top ${e} ${_} ${o},
 margin-bottom ${e} ${_} ${o},
 padding-top ${e} ${_} ${o},
 padding-bottom ${e} ${_} ${o}
 ${s?","+s:""}
 `),L(`&.fade-in-height-expand-transition-${h}-active`,`
 overflow: ${r};
 transition:
 max-height ${e} ${_},
 opacity ${e} ${Be},
 margin-top ${e} ${_},
 margin-bottom ${e} ${_},
 padding-top ${e} ${_},
 padding-bottom ${e} ${_}
 ${s?","+s:""}
 `)]}const Re=m("alert",`
 line-height: var(--n-line-height);
 border-radius: var(--n-border-radius);
 position: relative;
 transition: background-color .3s var(--n-bezier);
 background-color: var(--n-color);
 text-align: start;
 word-break: break-word;
`,[u("border",`
 border-radius: inherit;
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 transition: border-color .3s var(--n-bezier);
 border: var(--n-border);
 pointer-events: none;
 `),B("closable",[m("alert-body",[u("title",`
 padding-right: 24px;
 `)])]),u("icon",{color:"var(--n-icon-color)"}),m("alert-body",{padding:"var(--n-padding)"},[u("title",{color:"var(--n-title-text-color)"}),u("content",{color:"var(--n-content-text-color)"})]),Me({originalTransition:"transform .3s var(--n-bezier)",enterToProps:{transform:"scale(1)"},leaveToProps:{transform:"scale(0.9)"}}),u("icon",`
 position: absolute;
 left: 0;
 top: 0;
 align-items: center;
 justify-content: center;
 display: flex;
 width: var(--n-icon-size);
 height: var(--n-icon-size);
 font-size: var(--n-icon-size);
 margin: var(--n-icon-margin);
 `),u("close",`
 transition:
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier);
 position: absolute;
 right: 0;
 top: 0;
 margin: var(--n-close-margin);
 `),B("show-icon",[m("alert-body",{paddingLeft:"calc(var(--n-icon-margin-left) + var(--n-icon-size) + var(--n-icon-margin-right))"})]),m("alert-body",`
 border-radius: var(--n-border-radius);
 transition: border-color .3s var(--n-bezier);
 `,[u("title",`
 transition: color .3s var(--n-bezier);
 font-size: 16px;
 line-height: 19px;
 font-weight: var(--n-title-font-weight);
 `,[L("& +",[u("content",{marginTop:"9px"})])]),u("content",{transition:"color .3s var(--n-bezier)",fontSize:"var(--n-font-size)"})]),u("icon",{transition:"color .3s var(--n-bezier)"})]),Pe=Object.assign(Object.assign({},P.props),{title:String,showIcon:{type:Boolean,default:!0},type:{type:String,default:"default"},bordered:{type:Boolean,default:!0},closable:Boolean,onClose:Function,onAfterLeave:Function,onAfterHide:Function}),O=N({name:"Alert",inheritAttrs:!1,props:Pe,setup(r){const{mergedClsPrefixRef:e,mergedBorderedRef:s,inlineThemeDisabled:o,mergedRtlRef:c}=Z(r),a=P("Alert","-alert",Re,de,r,e),t=se("Alert",c,e),p=S(()=>{const{common:{cubicBezierEaseInOut:k},self:d}=a.value,{fontSize:F,borderRadius:G,titleFontWeight:U,lineHeight:J,iconSize:K,iconMargin:E,iconMarginRtl:q,closeIconSize:D,closeBorderRadius:Q,closeSize:X,closeMargin:Y,closeMarginRtl:ee,padding:te}=d,{type:C}=r,{left:ne,right:oe}=he(E);return{"--n-bezier":k,"--n-color":d[f("color",C)],"--n-close-icon-size":D,"--n-close-border-radius":Q,"--n-close-color-hover":d[f("closeColorHover",C)],"--n-close-color-pressed":d[f("closeColorPressed",C)],"--n-close-icon-color":d[f("closeIconColor",C)],"--n-close-icon-color-hover":d[f("closeIconColorHover",C)],"--n-close-icon-color-pressed":d[f("closeIconColorPressed",C)],"--n-icon-color":d[f("iconColor",C)],"--n-border":d[f("border",C)],"--n-title-text-color":d[f("titleTextColor",C)],"--n-content-text-color":d[f("contentTextColor",C)],"--n-line-height":J,"--n-border-radius":G,"--n-font-size":F,"--n-title-font-weight":U,"--n-icon-size":K,"--n-icon-margin":E,"--n-icon-margin-rtl":q,"--n-close-size":X,"--n-close-margin":Y,"--n-close-margin-rtl":ee,"--n-padding":te,"--n-icon-margin-left":ne,"--n-icon-margin-right":oe}}),h=o?H("alert",S(()=>r.type[0]),p,r):void 0,b=ye(!0),w=()=>{const{onAfterLeave:k,onAfterHide:d}=r;k&&k(),d&&d()};return{rtlEnabled:t,mergedClsPrefix:e,mergedBordered:s,visible:b,handleCloseClick:()=>{var k;Promise.resolve((k=r.onClose)===null||k===void 0?void 0:k.call(r)).then(d=>{d!==!1&&(b.value=!1)})},handleAfterLeave:()=>{w()},mergedTheme:a,cssVars:o?void 0:p,themeClass:h==null?void 0:h.themeClass,onRender:h==null?void 0:h.onRender}},render(){var r;return(r=this.onRender)===null||r===void 0||r.call(this),n(le,{onAfterLeave:this.handleAfterLeave},{default:()=>{const{mergedClsPrefix:e,$slots:s}=this,o={class:[`${e}-alert`,this.themeClass,this.closable&&`${e}-alert--closable`,this.showIcon&&`${e}-alert--show-icon`,this.rtlEnabled&&`${e}-alert--rtl`],style:this.cssVars,role:"alert"};return this.visible?n("div",Object.assign({},ke(this.$attrs,o)),this.closable&&n(Ce,{clsPrefix:e,class:`${e}-alert__close`,onClick:this.handleCloseClick}),this.bordered&&n("div",{class:`${e}-alert__border`}),this.showIcon&&n("div",{class:`${e}-alert__icon`,"aria-hidden":"true"},ie(s.icon,()=>[n(ce,{clsPrefix:e},{default:()=>{switch(this.type){case"success":return n(Se,null);case"info":return n(we,null);case"warning":return n(Ie,null);case"error":return n(Le,null);default:return null}}})])),n("div",{class:[`${e}-alert-body`,this.mergedBordered&&`${e}-alert-body--bordered`]},ae(s.header,c=>{const a=c||this.title;return a?n("div",{class:`${e}-alert-body__title`},a):null}),s.default&&n("div",{class:`${e}-alert-body__content`},s))):null}})}}),Ne=L([L("@keyframes spin-rotate",`
 from {
 transform: rotate(0);
 }
 to {
 transform: rotate(360deg);
 }
 `),m("spin-container",{position:"relative"},[m("spin-body",`
 position: absolute;
 top: 50%;
 left: 50%;
 transform: translateX(-50%) translateY(-50%);
 `,[pe()])]),m("spin-body",`
 display: inline-flex;
 align-items: center;
 justify-content: center;
 flex-direction: column;
 `),m("spin",`
 display: inline-flex;
 height: var(--n-size);
 width: var(--n-size);
 font-size: var(--n-size);
 color: var(--n-color);
 `,[B("rotate",`
 animation: spin-rotate 2s linear infinite;
 `)]),m("spin-description",`
 display: inline-block;
 font-size: var(--n-font-size);
 color: var(--n-text-color);
 transition: color .3s var(--n-bezier);
 margin-top: 8px;
 `),m("spin-content",`
 opacity: 1;
 transition: opacity .3s var(--n-bezier);
 pointer-events: all;
 `,[B("spinning",`
 user-select: none;
 -webkit-user-select: none;
 pointer-events: none;
 opacity: var(--n-opacity-spinning);
 `)])]),Oe={small:20,medium:18,large:16},je=Object.assign(Object.assign({},P.props),{description:String,stroke:String,size:{type:[String,Number],default:"medium"},show:{type:Boolean,default:!0},strokeWidth:Number,rotate:{type:Boolean,default:!0},spinning:{type:Boolean,validator:()=>!0,default:void 0}}),V=N({name:"Spin",props:je,setup(r){const{mergedClsPrefixRef:e,inlineThemeDisabled:s}=Z(r),o=P("Spin","-spin",Ne,fe,r,e),c=S(()=>{const{size:t}=r,{common:{cubicBezierEaseInOut:p},self:h}=o.value,{opacitySpinning:b,color:w,textColor:I}=h,i=typeof t=="number"?ge(t):h[f("size",t)];return{"--n-bezier":p,"--n-opacity-spinning":b,"--n-size":i,"--n-color":w,"--n-text-color":I}}),a=s?H("spin",S(()=>{const{size:t}=r;return typeof t=="number"?String(t):t[0]}),c,r):void 0;return{mergedClsPrefix:e,compitableShow:_e(r,["spinning","show"]),mergedStrokeWidth:S(()=>{const{strokeWidth:t}=r;if(t!==void 0)return t;const{size:p}=r;return Oe[typeof p=="number"?"medium":p]}),cssVars:s?void 0:c,themeClass:a==null?void 0:a.themeClass,onRender:a==null?void 0:a.onRender}},render(){var r,e;const{$slots:s,mergedClsPrefix:o,description:c}=this,a=s.icon&&this.rotate,t=(c||s.description)&&n("div",{class:`${o}-spin-description`},c||((r=s.description)===null||r===void 0?void 0:r.call(s))),p=s.icon?n("div",{class:[`${o}-spin-body`,this.themeClass]},n("div",{class:[`${o}-spin`,a&&`${o}-spin--rotate`],style:s.default?"":this.cssVars},s.icon()),t):n("div",{class:[`${o}-spin-body`,this.themeClass]},n(ue,{clsPrefix:o,style:s.default?"":this.cssVars,stroke:this.stroke,"stroke-width":this.mergedStrokeWidth,class:`${o}-spin`}),t);return(e=this.onRender)===null||e===void 0||e.call(this),s.default?n("div",{class:[`${o}-spin-container`,this.themeClass],style:this.cssVars},n("div",{class:[`${o}-spin-content`,this.compitableShow&&`${o}-spin-content--spinning`]},s),n($e,{name:"fade-in-transition"},{default:()=>this.compitableShow?p:null})):p}}),Ee=v("b",null,"client_id: ",-1),Ae=v("b",null,"client_secret: ",-1),Ve=v("b",null,"zone: ",-1),Ze=v("p",null,[v("b",null,"redirect_uri: "),y("https://alist.nn.ci/tool/onedrive/callback")],-1),He={key:2},We=v("b",null,"refresh_token: ",-1),Fe=v("h3",null,"Get sharepoint site ID",-1),Ge={key:2},Ue=v("b",null,"site_id: ",-1),Je=N({__name:"Callback",setup(r){const e=new URL(window.location.href),s=e.searchParams.get("code"),o=e.searchParams.get("state"),c=e.searchParams.get("error"),a=e.searchParams.get("error_description"),t=xe({refreshToken:"",accessToken:"",error1:"",errorMessage1:"",siteUrl:"",siteId:"",error2:"",errorMessage2:"",gettingSiteId:!1});s&&o&&!c&&(()=>{fetch("https://api.nn.ci/alist/onedrive/get_refresh_token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:s,client:o})}).then(i=>i.json()).then(i=>{if(console.log(i),i.error){t.error1=i.error,t.errorMessage1=i.error_description;return}t.refreshToken=i.refresh_token,t.accessToken=i.access_token})})();const[h,b,w]=atob(o).split("::"),I=()=>{t.gettingSiteId=!0,fetch("https://api.nn.ci/alist/onedrive/get_site_id",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({site_url:t.siteUrl,access_token:t.accessToken,zone:w})}).then(i=>(t.gettingSiteId=!1,i.json())).then(i=>{if(i.error){t.error2=i.error,t.errorMessage2=i.error.message;return}t.siteId=i.id})};return(i,k)=>(g(),$(be,null,{default:z(()=>[!l(s)||!l(o)||l(c)?(g(),$(l(O),{key:0,title:l(c)||"Error",type:"error"},{default:z(()=>[y(x(l(a)),1)]),_:1},8,["title"])):(g(),$(l(A),{key:1,vertical:"",size:"large"},{default:z(()=>[v("p",null,[Ee,y(x(l(h)),1)]),v("p",null,[Ae,y(x(l(b)),1)]),v("p",null,[Ve,y(x(l(w)),1)]),Ze,t.error1||t.errorMessage1?(g(),$(l(O),{key:0,title:t.error1,type:"error"},{default:z(()=>[y(x(t.errorMessage1),1)]),_:1},8,["title"])):T("v-if",!0),t.refreshToken?(g(),j("p",He,[We,y(x(t.refreshToken),1)])):(g(),$(l(V),{key:1})),t.accessToken?(g(),$(l(A),{key:3,vertical:"",size:"large"},{default:z(()=>[Fe,t.error2||t.errorMessage2?(g(),$(l(O),{key:0,title:t.error2,type:"error"},{default:z(()=>[y(x(t.errorMessage2),1)]),_:1},8,["title"])):T("v-if",!0),M(l(me),{placeholder:"input site url (https://xx.sharepoint.xx/sites/xx)",size:"large"}),M(l(ve),{type:"primary",size:"large",onClick:I},{default:z(()=>[y("Get SiteID")]),_:1}),t.gettingSiteId?(g(),$(l(V),{key:1})):t.siteId?(g(),j("p",Ge,[Ue,y(x(t.siteId),1)])):T("v-if",!0)]),_:1})):T("v-if",!0)]),_:1}))]),_:1}))}});const Ke=W(Je,[["__file","Callback.vue"]]),qe=N({__name:"callback.html",setup(r){return(e,s)=>{const o=ze("ClientOnly");return g(),j("div",null,[M(o,null,{default:z(()=>[M(l(Ke))]),_:1})])}}}),Ye=W(qe,[["__file","callback.html.vue"]]);export{Ye as default};
