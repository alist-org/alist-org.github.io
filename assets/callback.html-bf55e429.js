import{r as R,u as se,a as Z,b as ie,c as ae,N as le,d as ce,g as de,e as f,f as he,h as ue,p as pe,i as A,j as O,k as fe}from"./Space-459979f0.js";import{c as L,a as ge,b as g,d as p,e as M,u as H,f as N,g as me,s as ve}from"./app-98b41894.js";import{N as be,u as Ce}from"./Close-add51d1c.js";import{j as n,c as P,h as T,r as _e,aa as ye,T as $e,b as ke,u as i,N as y,O as x,P as k,a5 as $,a7 as z,Q as m,ab as I,Z as S,a4 as W,_ as F,G as xe}from"./framework-fee3bc76.js";const ze=R("error",n("svg",{viewBox:"0 0 48 48",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},n("g",{stroke:"none","stroke-width":"1","fill-rule":"evenodd"},n("g",{"fill-rule":"nonzero"},n("path",{d:"M24,4 C35.045695,4 44,12.954305 44,24 C44,35.045695 35.045695,44 24,44 C12.954305,44 4,35.045695 4,24 C4,12.954305 12.954305,4 24,4 Z M17.8838835,16.1161165 L17.7823881,16.0249942 C17.3266086,15.6583353 16.6733914,15.6583353 16.2176119,16.0249942 L16.1161165,16.1161165 L16.0249942,16.2176119 C15.6583353,16.6733914 15.6583353,17.3266086 16.0249942,17.7823881 L16.1161165,17.8838835 L22.233,24 L16.1161165,30.1161165 L16.0249942,30.2176119 C15.6583353,30.6733914 15.6583353,31.3266086 16.0249942,31.7823881 L16.1161165,31.8838835 L16.2176119,31.9750058 C16.6733914,32.3416647 17.3266086,32.3416647 17.7823881,31.9750058 L17.8838835,31.8838835 L24,25.767 L30.1161165,31.8838835 L30.2176119,31.9750058 C30.6733914,32.3416647 31.3266086,32.3416647 31.7823881,31.9750058 L31.8838835,31.8838835 L31.9750058,31.7823881 C32.3416647,31.3266086 32.3416647,30.6733914 31.9750058,30.2176119 L31.8838835,30.1161165 L25.767,24 L31.8838835,17.8838835 L31.9750058,17.7823881 C32.3416647,17.3266086 32.3416647,16.6733914 31.9750058,16.2176119 L31.8838835,16.1161165 L31.7823881,16.0249942 C31.3266086,15.6583353 30.6733914,15.6583353 30.2176119,16.0249942 L30.1161165,16.1161165 L24,22.233 L17.8838835,16.1161165 L17.7823881,16.0249942 L17.8838835,16.1161165 Z"}))))),Le=R("info",n("svg",{viewBox:"0 0 28 28",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},n("g",{stroke:"none","stroke-width":"1","fill-rule":"evenodd"},n("g",{"fill-rule":"nonzero"},n("path",{d:"M14,2 C20.6274,2 26,7.37258 26,14 C26,20.6274 20.6274,26 14,26 C7.37258,26 2,20.6274 2,14 C2,7.37258 7.37258,2 14,2 Z M14,11 C13.4477,11 13,11.4477 13,12 L13,12 L13,20 C13,20.5523 13.4477,21 14,21 C14.5523,21 15,20.5523 15,20 L15,20 L15,12 C15,11.4477 14.5523,11 14,11 Z M14,6.75 C13.3096,6.75 12.75,7.30964 12.75,8 C12.75,8.69036 13.3096,9.25 14,9.25 C14.6904,9.25 15.25,8.69036 15.25,8 C15.25,7.30964 14.6904,6.75 14,6.75 Z"}))))),we=R("success",n("svg",{viewBox:"0 0 48 48",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},n("g",{stroke:"none","stroke-width":"1","fill-rule":"evenodd"},n("g",{"fill-rule":"nonzero"},n("path",{d:"M24,4 C35.045695,4 44,12.954305 44,24 C44,35.045695 35.045695,44 24,44 C12.954305,44 4,35.045695 4,24 C4,12.954305 12.954305,4 24,4 Z M32.6338835,17.6161165 C32.1782718,17.1605048 31.4584514,17.1301307 30.9676119,17.5249942 L30.8661165,17.6161165 L20.75,27.732233 L17.1338835,24.1161165 C16.6457281,23.6279612 15.8542719,23.6279612 15.3661165,24.1161165 C14.9105048,24.5717282 14.8801307,25.2915486 15.2749942,25.7823881 L15.3661165,25.8838835 L19.8661165,30.3838835 C20.3217282,30.8394952 21.0415486,30.8698693 21.5323881,30.4750058 L21.6338835,30.3838835 L32.6338835,19.3838835 C33.1220388,18.8957281 33.1220388,18.1042719 32.6338835,17.6161165 Z"}))))),Se=R("warning",n("svg",{viewBox:"0 0 24 24",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},n("g",{stroke:"none","stroke-width":"1","fill-rule":"evenodd"},n("g",{"fill-rule":"nonzero"},n("path",{d:"M12,2 C17.523,2 22,6.478 22,12 C22,17.522 17.523,22 12,22 C6.477,22 2,17.522 2,12 C2,6.478 6.477,2 12,2 Z M12.0018002,15.0037242 C11.450254,15.0037242 11.0031376,15.4508407 11.0031376,16.0023869 C11.0031376,16.553933 11.450254,17.0010495 12.0018002,17.0010495 C12.5533463,17.0010495 13.0004628,16.553933 13.0004628,16.0023869 C13.0004628,15.4508407 12.5533463,15.0037242 12.0018002,15.0037242 Z M11.99964,7 C11.4868042,7.00018474 11.0642719,7.38637706 11.0066858,7.8837365 L11,8.00036004 L11.0018003,13.0012393 L11.00857,13.117858 C11.0665141,13.6151758 11.4893244,14.0010638 12.0021602,14.0008793 C12.514996,14.0006946 12.9375283,13.6145023 12.9951144,13.1171428 L13.0018002,13.0005193 L13,7.99964009 L12.9932303,7.8830214 C12.9352861,7.38570354 12.5124758,6.99981552 11.99964,7 Z"}))))),{cubicBezierEaseInOut:C,cubicBezierEaseOut:Ie,cubicBezierEaseIn:Te}=ge;function Be({overflow:r="hidden",duration:e=".3s",originalTransition:s="",leavingDelay:o="0s",foldPadding:c=!1,enterToProps:l=void 0,leaveToProps:t=void 0,reverse:u=!1}={}){const h=u?"leave":"enter",v=u?"enter":"leave";return[L(`&.fade-in-height-expand-transition-${v}-from,
 &.fade-in-height-expand-transition-${h}-to`,Object.assign(Object.assign({},l),{opacity:1})),L(`&.fade-in-height-expand-transition-${v}-to,
 &.fade-in-height-expand-transition-${h}-from`,Object.assign(Object.assign({},t),{opacity:0,marginTop:"0 !important",marginBottom:"0 !important",paddingTop:c?"0 !important":void 0,paddingBottom:c?"0 !important":void 0})),L(`&.fade-in-height-expand-transition-${v}-active`,`
 overflow: ${r};
 transition:
 max-height ${e} ${C} ${o},
 opacity ${e} ${Ie} ${o},
 margin-top ${e} ${C} ${o},
 margin-bottom ${e} ${C} ${o},
 padding-top ${e} ${C} ${o},
 padding-bottom ${e} ${C} ${o}
 ${s?","+s:""}
 `),L(`&.fade-in-height-expand-transition-${h}-active`,`
 overflow: ${r};
 transition:
 max-height ${e} ${C},
 opacity ${e} ${Te},
 margin-top ${e} ${C},
 margin-bottom ${e} ${C},
 padding-top ${e} ${C},
 padding-bottom ${e} ${C}
 ${s?","+s:""}
 `)]}const Me=g("alert",`
 line-height: var(--n-line-height);
 border-radius: var(--n-border-radius);
 position: relative;
 transition: background-color .3s var(--n-bezier);
 background-color: var(--n-color);
 text-align: start;
 word-break: break-word;
`,[p("border",`
 border-radius: inherit;
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 transition: border-color .3s var(--n-bezier);
 border: var(--n-border);
 pointer-events: none;
 `),M("closable",[g("alert-body",[p("title",`
 padding-right: 24px;
 `)])]),p("icon",{color:"var(--n-icon-color)"}),g("alert-body",{padding:"var(--n-padding)"},[p("title",{color:"var(--n-title-text-color)"}),p("content",{color:"var(--n-content-text-color)"})]),Be({originalTransition:"transform .3s var(--n-bezier)",enterToProps:{transform:"scale(1)"},leaveToProps:{transform:"scale(0.9)"}}),p("icon",`
 position: absolute;
 left: 0;
 top: 0;
 align-items: center;
 justify-content: center;
 display: flex;
 width: var(--n-icon-size);
 height: var(--n-icon-size);
 font-size: var(--n-icon-size);
 margin: var(--n-icon-margin);
 `),p("close",`
 transition:
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier);
 position: absolute;
 right: 0;
 top: 0;
 margin: var(--n-close-margin);
 `),M("show-icon",[g("alert-body",{paddingLeft:"calc(var(--n-icon-margin-left) + var(--n-icon-size) + var(--n-icon-margin-right))"})]),g("alert-body",`
 border-radius: var(--n-border-radius);
 transition: border-color .3s var(--n-bezier);
 `,[p("title",`
 transition: color .3s var(--n-bezier);
 font-size: 16px;
 line-height: 19px;
 font-weight: var(--n-title-font-weight);
 `,[L("& +",[p("content",{marginTop:"9px"})])]),p("content",{transition:"color .3s var(--n-bezier)",fontSize:"var(--n-font-size)"})]),p("icon",{transition:"color .3s var(--n-bezier)"})]),Re=Object.assign(Object.assign({},N.props),{title:String,showIcon:{type:Boolean,default:!0},type:{type:String,default:"default"},bordered:{type:Boolean,default:!0},closable:Boolean,onClose:Function,onAfterLeave:Function,onAfterHide:Function}),j=P({name:"Alert",inheritAttrs:!1,props:Re,setup(r){const{mergedClsPrefixRef:e,mergedBorderedRef:s,inlineThemeDisabled:o,mergedRtlRef:c}=H(r),l=N("Alert","-alert",Me,me,r,e),t=se("Alert",c,e),u=T(()=>{const{common:{cubicBezierEaseInOut:_},self:d}=l.value,{fontSize:G,borderRadius:U,titleFontWeight:J,lineHeight:K,iconSize:D,iconMargin:E,iconMarginRtl:Q,closeIconSize:X,closeBorderRadius:Y,closeSize:q,closeMargin:ee,closeMarginRtl:te,padding:ne}=d,{type:b}=r,{left:oe,right:re}=de(E);return{"--n-bezier":_,"--n-color":d[f("color",b)],"--n-close-icon-size":X,"--n-close-border-radius":Y,"--n-close-color-hover":d[f("closeColorHover",b)],"--n-close-color-pressed":d[f("closeColorPressed",b)],"--n-close-icon-color":d[f("closeIconColor",b)],"--n-close-icon-color-hover":d[f("closeIconColorHover",b)],"--n-close-icon-color-pressed":d[f("closeIconColorPressed",b)],"--n-icon-color":d[f("iconColor",b)],"--n-border":d[f("border",b)],"--n-title-text-color":d[f("titleTextColor",b)],"--n-content-text-color":d[f("contentTextColor",b)],"--n-line-height":K,"--n-border-radius":U,"--n-font-size":G,"--n-title-font-weight":J,"--n-icon-size":D,"--n-icon-margin":E,"--n-icon-margin-rtl":Q,"--n-close-size":q,"--n-close-margin":ee,"--n-close-margin-rtl":te,"--n-padding":ne,"--n-icon-margin-left":oe,"--n-icon-margin-right":re}}),h=o?Z("alert",T(()=>r.type[0]),u,r):void 0,v=_e(!0),w=()=>{const{onAfterLeave:_,onAfterHide:d}=r;_&&_(),d&&d()};return{rtlEnabled:t,mergedClsPrefix:e,mergedBordered:s,visible:v,handleCloseClick:()=>{var _;Promise.resolve((_=r.onClose)===null||_===void 0?void 0:_.call(r)).then(d=>{d!==!1&&(v.value=!1)})},handleAfterLeave:()=>{w()},mergedTheme:l,cssVars:o?void 0:u,themeClass:h==null?void 0:h.themeClass,onRender:h==null?void 0:h.onRender}},render(){var r;return(r=this.onRender)===null||r===void 0||r.call(this),n(le,{onAfterLeave:this.handleAfterLeave},{default:()=>{const{mergedClsPrefix:e,$slots:s}=this,o={class:[`${e}-alert`,this.themeClass,this.closable&&`${e}-alert--closable`,this.showIcon&&`${e}-alert--show-icon`,this.rtlEnabled&&`${e}-alert--rtl`],style:this.cssVars,role:"alert"};return this.visible?n("div",Object.assign({},ye(this.$attrs,o)),this.closable&&n(be,{clsPrefix:e,class:`${e}-alert__close`,onClick:this.handleCloseClick}),this.bordered&&n("div",{class:`${e}-alert__border`}),this.showIcon&&n("div",{class:`${e}-alert__icon`,"aria-hidden":"true"},ie(s.icon,()=>[n(ce,{clsPrefix:e},{default:()=>{switch(this.type){case"success":return n(we,null);case"info":return n(Le,null);case"warning":return n(Se,null);case"error":return n(ze,null);default:return null}}})])),n("div",{class:[`${e}-alert-body`,this.mergedBordered&&`${e}-alert-body--bordered`]},ae(s.header,c=>{const l=c||this.title;return l?n("div",{class:`${e}-alert-body__title`},l):null}),s.default&&n("div",{class:`${e}-alert-body__content`},s))):null}})}}),Ne=L([L("@keyframes spin-rotate",`
 from {
 transform: rotate(0);
 }
 to {
 transform: rotate(360deg);
 }
 `),g("spin-container",{position:"relative"},[g("spin-body",`
 position: absolute;
 top: 50%;
 left: 50%;
 transform: translateX(-50%) translateY(-50%);
 `,[he()])]),g("spin-body",`
 display: inline-flex;
 align-items: center;
 justify-content: center;
 flex-direction: column;
 `),g("spin",`
 display: inline-flex;
 height: var(--n-size);
 width: var(--n-size);
 font-size: var(--n-size);
 color: var(--n-color);
 `,[M("rotate",`
 animation: spin-rotate 2s linear infinite;
 `)]),g("spin-description",`
 display: inline-block;
 font-size: var(--n-font-size);
 color: var(--n-text-color);
 transition: color .3s var(--n-bezier);
 margin-top: 8px;
 `),g("spin-content",`
 opacity: 1;
 transition: opacity .3s var(--n-bezier);
 pointer-events: all;
 `,[M("spinning",`
 user-select: none;
 -webkit-user-select: none;
 pointer-events: none;
 opacity: var(--n-opacity-spinning);
 `)])]),Pe={small:20,medium:18,large:16},Oe=Object.assign(Object.assign({},N.props),{description:String,stroke:String,size:{type:[String,Number],default:"medium"},show:{type:Boolean,default:!0},strokeWidth:Number,rotate:{type:Boolean,default:!0},spinning:{type:Boolean,validator:()=>!0,default:void 0}}),V=P({name:"Spin",props:Oe,setup(r){const{mergedClsPrefixRef:e,inlineThemeDisabled:s}=H(r),o=N("Spin","-spin",Ne,ve,r,e),c=T(()=>{const{size:t}=r,{common:{cubicBezierEaseInOut:u},self:h}=o.value,{opacitySpinning:v,color:w,textColor:B}=h,a=typeof t=="number"?pe(t):h[f("size",t)];return{"--n-bezier":u,"--n-opacity-spinning":v,"--n-size":a,"--n-color":w,"--n-text-color":B}}),l=s?Z("spin",T(()=>{const{size:t}=r;return typeof t=="number"?String(t):t[0]}),c,r):void 0;return{mergedClsPrefix:e,compitableShow:Ce(r,["spinning","show"]),mergedStrokeWidth:T(()=>{const{strokeWidth:t}=r;if(t!==void 0)return t;const{size:u}=r;return Pe[typeof u=="number"?"medium":u]}),cssVars:s?void 0:c,themeClass:l==null?void 0:l.themeClass,onRender:l==null?void 0:l.onRender}},render(){var r,e;const{$slots:s,mergedClsPrefix:o,description:c}=this,l=s.icon&&this.rotate,t=(c||s.description)&&n("div",{class:`${o}-spin-description`},c||((r=s.description)===null||r===void 0?void 0:r.call(s))),u=s.icon?n("div",{class:[`${o}-spin-body`,this.themeClass]},n("div",{class:[`${o}-spin`,l&&`${o}-spin--rotate`],style:s.default?"":this.cssVars},s.icon()),t):n("div",{class:[`${o}-spin-body`,this.themeClass]},n(ue,{clsPrefix:o,style:s.default?"":this.cssVars,stroke:this.stroke,"stroke-width":this.mergedStrokeWidth,class:`${o}-spin`}),t);return(e=this.onRender)===null||e===void 0||e.call(this),s.default?n("div",{class:[`${o}-spin-container`,this.themeClass],style:this.cssVars},n("div",{class:[`${o}-spin-content`,this.compitableShow&&`${o}-spin-content--spinning`]},s),n($e,{name:"fade-in-transition"},{default:()=>this.compitableShow?u:null})):u}}),je=m("b",null,"client_id: ",-1),Ee=m("b",null,"client_secret: ",-1),Ae=m("b",null,"zone: ",-1),Ve=m("p",null,[m("b",null,"redirect_uri: "),$("https://alist.nn.ci/tool/onedrive/callback")],-1),Ze=m("b",null,"refresh_token",-1),He=m("h3",null,"Get sharepoint site ID",-1),We={key:2},Fe=m("b",null,"site_id: ",-1),Ge=P({__name:"Callback",setup(r){const e=new URL(window.location.href),s=e.searchParams.get("code"),o=e.searchParams.get("state"),c=e.searchParams.get("error"),l=e.searchParams.get("error_description"),t=ke({refreshToken:"",accessToken:"",error1:"",errorMessage1:"",siteUrl:"",siteId:"",error2:"",errorMessage2:"",gettingSiteId:!1});s&&o&&!c&&(()=>{fetch("https://api.nn.ci/alist/onedrive/get_refresh_token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:s,client:o})}).then(a=>a.json()).then(a=>{if(console.log(a),a.error){t.error1=a.error,t.errorMessage1=a.error_description;return}t.refreshToken=a.refresh_token,t.accessToken=a.access_token})})();const[h,v,w]=atob(o).split("::"),B=()=>{t.gettingSiteId=!0,fetch("https://api.nn.ci/alist/onedrive/get_site_id",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({site_url:t.siteUrl,access_token:t.accessToken,zone:w})}).then(a=>(t.gettingSiteId=!1,a.json())).then(a=>{if(a.error){t.error2=a.error,t.errorMessage2=a.error.message;return}t.siteId=a.id})};return(a,_)=>!i(s)||!i(o)||i(c)?(y(),x(i(j),{key:0,title:i(c)||"Error",type:"error"},{default:k(()=>[$(z(i(l)),1)]),_:1},8,["title"])):(y(),x(i(O),{key:1,vertical:"",size:"large"},{default:k(()=>[m("p",null,[je,$(z(i(h)),1)]),m("p",null,[Ee,$(z(i(v)),1)]),m("p",null,[Ae,$(z(i(w)),1)]),Ve,t.error1||t.errorMessage1?(y(),x(i(j),{key:0,title:t.error1,type:"error"},{default:k(()=>[$(z(t.errorMessage1),1)]),_:1},8,["title"])):I("v-if",!0),t.refreshToken?I("v-if",!0):(y(),x(i(V),{key:1})),S(i(O),{vertical:""},{default:k(()=>[Ze,S(i(A),{type:"textarea",readonly:"",value:t.refreshToken},null,8,["value"])]),_:1}),t.accessToken?(y(),x(i(O),{key:2,vertical:"",size:"large"},{default:k(()=>[He,t.error2||t.errorMessage2?(y(),x(i(j),{key:0,title:t.error2,type:"error"},{default:k(()=>[$(z(t.errorMessage2),1)]),_:1},8,["title"])):I("v-if",!0),S(i(A),{placeholder:"input site url (https://xx.sharepoint.xx/sites/xx)",size:"large"}),S(i(fe),{type:"primary",size:"large",onClick:B},{default:k(()=>[$("Get SiteID")]),_:1}),t.gettingSiteId?(y(),x(i(V),{key:1})):t.siteId?(y(),W("p",We,[Fe,$(z(t.siteId),1)])):I("v-if",!0)]),_:1})):I("v-if",!0)]),_:1}))}});const Ue=F(Ge,[["__file","Callback.vue"]]),Je=P({__name:"callback.html",setup(r){return(e,s)=>{const o=xe("NaiveClient");return y(),W("div",null,[S(o,null,{default:k(()=>[S(i(Ue))]),_:1})])}}}),Ye=F(Je,[["__file","callback.html.vue"]]);export{Ye as default};
