import{_ as m,a as v,b as k,c as _,d as b,e as f,f as g,g as y,h as w,i as x}from"./onedrive_app_user-d7abb45b.js";import{_ as A,N as z,a9 as I,Q as e,W as n,a1 as t,P as o,ag as u,G as i}from"./framework-95cb4087.js";const D={},T=u('<h1 id="onedrive-app" tabindex="-1"><a class="header-anchor" href="#onedrive-app" aria-hidden="true">#</a> OneDrive APP</h1><h2 id="benefits-and-precautions" tabindex="-1"><a class="header-anchor" href="#benefits-and-precautions" aria-hidden="true">#</a> Benefits and Precautions</h2><ol><li><p>The advantage is that the administrator is only authorized to log in once, and the same is used when adding parameters later. When adding, everything is the same except for the mailbox.</p><ul><li>For example, E5 has 25 5T accounts. After you log in and initialize in advance, you can directly use the parameters before the CV. You don’t have to get the refresh token every time as before, and it will expire after a long time</li><li>A1, A1P, etc. can distribute more accounts (500 - <strong>unlimited</strong>)</li></ul></li><li><p>After the administrator authorizes in this way, he can view the account of each member in the organization at will, which will leak his own files</p><ul><li>It is recommended to apply for OneDrive E5 to get better</li></ul></li></ol><hr><p>First log in with your personal or organizational account</p>',5),P={href:"https://entra.microsoft.com/#view/Microsoft_AAD_IAM/TenantOverview.ReactView?Microsoft_AAD_IAM_legacyAADRedirect=true",target:"_blank",rel:"noopener noreferrer"},S=u('<p><img src="'+m+'" alt="onedriveapp"></p><h2 id="create-process" tabindex="-1"><a class="header-anchor" href="#create-process" aria-hidden="true">#</a> Create process</h2><div class="hint-container danger"><p class="hint-container-title">Read the precautions carefully</p><p>Please read carefully the following <strong><code>serial numbers , view in sequence</code></strong> , if there is any error, please feedback in time</p></div>',3),E=e("li",null,[e("p",null,"Register an application, choose the type yourself, it is recommended to choose the third")],-1),R={href:"https://entra.microsoft.com/TokenAuthorize",target:"_blank",rel:"noopener noreferrer"},C=e("p",null,[e("img",{src:v,alt:"onedriveapp"})],-1),B=e("p",null,[e("img",{src:k,alt:"onedriveapp"})],-1),O=e("p",null,[n("Once you have obtained the client secret key, go to authorize the "),e("strong",null,[e("code",null,"API")]),n(" to be used, and follow the picture below to get it")],-1),L=e("p",null,[e("img",{src:_,alt:"onedriveapp"})],-1),M=e("p",null,"After the API is authorized, we go to authorize the organization application",-1),V=e("ul",null,[e("li",null,[n("Left sidebar ---> Enterprise applications ---> All applications ---> "),e("strong",null,"{choose which application name we started to create}"),n(" ---> Permissions ---> Click for "),e("code",null,"xxxx "),n("Grant admin consent")])],-1),N=e("p",null,[e("img",{src:b,alt:"onedriveapp"})],-1),K=e("p",null,"matters needing attention",-1),W=e("ul",null,[e("li",null,"If you start to register the application, the callback parameters are not the same, you may get an error when you click Authorization, remember to write the same"),e("li",null,[n("How to check whether the authorization is successful. If it is not authorized, the page will prompt "),e("code",null,"The application has not been found to have the authorization of the administrator's permission"),n(". After the authorization is successful, refresh the page and you will see three API permissions, as shown in the figure below "),e("ul",null,[e("li",null,"The above is what it looks like when it is not authorized, and the following is what it looks like after authorization (just refresh the page after authorization)")])])],-1),F=e("p",null,[e("img",{src:f,alt:"onedriveapp"})],-1),U=e("p",null,[n("From the beginning to the present, we have obtained the following parameters: tenant ID"),e("sup",null,"1"),n(", registered application"),e("sup",null,"2"),n(", client ID/secret key"),e("sup",null,"3"),n(", authorization API/administrator API"),e("sup",null,"4")],-1),Y=e("div",{class:"language-html line-numbers-mode","data-ext":"html"},[e("pre",{class:"language-html"},[e("code",null,`https://login.microsoftonline.com/{tenant ID or common}/adminConsent?client_id={client ID}&redirect_uri={Callback URL}
`)]),e("div",{class:"line-numbers","aria-hidden":"true"},[e("div",{class:"line-number"})])],-1),H=e("p",null,[e("img",{src:g,alt:"onedriveapp"})],-1),Q=e("p",null,"If you log in according to the spelled link and find that you are redirected to a blank page, such as the sample code and picture below, the authorization is successful, don’t worry",-1),q=e("div",{class:"language-text line-numbers-mode","data-ext":"text"},[e("pre",{class:"language-text"},[e("code",null,`https://entra.microsoft.com/TokenAuthorize?admin_consent=True&tenant={Tenant ID}#
`)]),e("div",{class:"line-numbers","aria-hidden":"true"},[e("div",{class:"line-number"})])],-1),G=e("p",null,[e("img",{src:y,alt:"onedriveapp"})],-1),X=e("h2",{id:"fill-in-the-example",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#fill-in-the-example","aria-hidden":"true"},"#"),n(" Fill in the example")],-1),j=e("p",null,[n("Fill in the values obtained in the above process one by one. If you don’t know which email address it is, you can find it by "),e("a",{href:"#view-all-users-of-the-organization"},[e("strong",null,"view all users of the organization")])],-1),Z=e("p",null,[e("img",{src:w,alt:"onedriveapp"})],-1),J=e("h2",{id:"view-all-users-of-the-organization",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#view-all-users-of-the-organization","aria-hidden":"true"},"#"),n(" View all users of the organization")],-1),$=e("p",null,[n("If you don't know how many users there are in your OneDrive organization, you can go to the link below to log in to the "),e("code",null,"admin"),n(" account to view")],-1),ee={href:"https://admin.microsoft.com/Adminportal/Home?source=applauncher#/users",target:"_blank",rel:"noopener noreferrer"},ne=e("p",null,[e("img",{src:x,alt:"onedriveapp"})],-1),te=e("h2",{id:"error-message",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#error-message","aria-hidden":"true"},"#"),n(" Error message")],-1),ae=e("ul",null,[e("li",null,[n("Tips："),e("strong",null,"Either scp or roles claim need to be present in the token"),n(" Error")])],-1),se=e("code",null,"4",-1),oe=e("h2",{id:"add-onedrive-app-accounts-in-batches",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#add-onedrive-app-accounts-in-batches","aria-hidden":"true"},"#"),n(" Add OneDrive_App accounts in batches")],-1),ie={href:"https://github.com/yzbtdiy/alist_batch",target:"_blank",rel:"noopener noreferrer"},le={href:"https://www.bilibili.com/video/BV1vc411V78S",target:"_blank",rel:"noopener noreferrer"},re=u(`<details class="hint-container details"><summary>Fill in the parameters. If you don’t understand, you can watch the video below.</summary><p>Do not leave blank lines in the two configuration files, as this will also report an error</p><p><strong>config.yaml</strong></p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token comment"># Your own AList site, which can be local or remote server IP or domain name, but cannot have &quot;/&quot; at the end</span>
<span class="token key atrule">url</span><span class="token punctuation">:</span> ALIST_URL
<span class="token comment"># The three parameters of auth are your AList administrator account password and refresh token</span>
<span class="token key atrule">auth</span><span class="token punctuation">:</span>
    <span class="token key atrule">username</span><span class="token punctuation">:</span> USERNAME
    <span class="token key atrule">password</span><span class="token punctuation">:</span> PASSWORD
<span class="token key atrule">token</span><span class="token punctuation">:</span> ALIST_TOKEN
<span class="token comment"># enable Turn on whichever option you need, and turn off the one you don’t need</span>
<span class="token key atrule">aliyun</span><span class="token punctuation">:</span>
    <span class="token key atrule">enable</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
    <span class="token key atrule">refresh_token</span><span class="token punctuation">:</span> ALI_YUNPAN_REFRESH_TOKEN
<span class="token key atrule">pikpak</span><span class="token punctuation">:</span>
    <span class="token key atrule">enable</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
    <span class="token key atrule">username</span><span class="token punctuation">:</span> PIKPAK_EMAIL
    <span class="token key atrule">password</span><span class="token punctuation">:</span> PIKPAK_PASSWORD
<span class="token comment"># What we need here is onedrive_app, turn this on</span>
<span class="token key atrule">onedrive_app</span><span class="token punctuation">:</span>
    <span class="token key atrule">enable</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
<span class="token comment"># global is global, such as E5 A1 A1P, Vianet is cn, German version is de, American version is us</span>
    <span class="token key atrule">region</span><span class="token punctuation">:</span> global
    <span class="token key atrule">tenants</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> <span class="token number">1</span>
          <span class="token key atrule">client_id</span><span class="token punctuation">:</span> client_id
          <span class="token key atrule">client_secret</span><span class="token punctuation">:</span> client_secret
          <span class="token key atrule">tenant_id</span><span class="token punctuation">:</span> tenant_id
<span class="token comment"># Here you can mount different domains and different accounts at the same time, each domain can be written according to the above configuration</span>
<span class="token comment"># Client ID Client Secret Key Tenant ID Needless to say?</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>onedrive_app.yaml</strong></p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token comment"># Category 1 Mount x can be changed at will, which is equivalent to the mount path when adding storage</span>
<span class="token comment"># 1 This refers to which domain/organization configuration in the above configuration file is to be used</span>
<span class="token comment"># What follows is your email account~ If you don&#39;t write &quot;:/folder1&quot;, the root directory will be mounted, and if you write it, you will mount this directory</span>
<span class="token comment"># Anyway, the format is: Mount path: domain/organization: email account: / folder directory (optional)</span>
<span class="token key atrule">Category</span><span class="token punctuation">:</span>
    <span class="token key atrule">mount</span><span class="token punctuation">:</span> 1<span class="token punctuation">:</span>user1@xxx.onmicrosoft.com
    <span class="token key atrule">mount2</span><span class="token punctuation">:</span> 1<span class="token punctuation">:</span>user2@xxx.onmicrosoft.com<span class="token punctuation">:</span>/folder1
    <span class="token key atrule">mount3</span><span class="token punctuation">:</span> 1<span class="token punctuation">:</span>user2@xxx.onmicrosoft.com<span class="token punctuation">:</span>/folder2
<span class="token comment"># You can mount it in multiple different lists, and write according to the format</span>
<span class="token key atrule">Category2</span><span class="token punctuation">:</span>
    <span class="token key atrule">mount11</span><span class="token punctuation">:</span> 1<span class="token punctuation">:</span>user1@xxx.onmicrosoft.com
    <span class="token key atrule">mount22</span><span class="token punctuation">:</span> 1<span class="token punctuation">:</span>user2@xxx.onmicrosoft.com<span class="token punctuation">:</span>/folder1
    <span class="token key atrule">mount33</span><span class="token punctuation">:</span> 1<span class="token punctuation">:</span>user2@xxx.onmicrosoft.com<span class="token punctuation">:</span>/folder2
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details><h3 id="the-default-download-method-used" tabindex="-1"><a class="header-anchor" href="#the-default-download-method-used" aria-hidden="true">#</a> The default download method used</h3>`,2);function ce(ue,pe){const s=i("ExternalLinkIcon"),a=i("Badge"),p=i("Tabs"),d=i("BiliBili"),h=i("Mermaid");return z(),I("div",null,[T,e("p",null,[e("strong",null,[e("a",P,[n("https://entra.microsoft.com/#view/Microsoft_AAD_IAM/TenantOverview.ReactView?Microsoft_AAD_IAM_legacyAADRedirect=true"),t(s)])])]),e("p",null,[n("Login to get our"),t(a,{text:"tenant ID",type:"info",vertical:"middle"})]),S,t(p,{id:"58",data:[{title:"1"},{title:"2"},{title:"3"},{title:"4"},{title:"5"}],"tab-id":"onedrive_app"},{tab0:o(({title:l,value:r,isActive:c})=>[e("ol",null,[E,e("li",null,[e("p",null,[n("Redirect URL (callback parameter), select Web as the type, and fill in the parameters "),e("strong",null,[e("a",R,[n("https://entra.microsoft.com/TokenAuthorize"),t(s)])]),n(" ,Otherwise, it will not be able to authorize later")])]),e("li",null,[e("p",null,[n("After filling out, click on the registration below and you can see it after jumping"),t(a,{text:"client ID",type:"info",vertical:"middle"})])])]),C]),tab1:o(({title:l,value:r,isActive:c})=>[e("p",null,[n("Let's get a client secret key, just get it as shown in the figure below, remember"),t(a,{text:"secret key",type:"info",vertical:"middle"}),n("save in time, it will only appear once")]),B]),tab2:o(({title:l,value:r,isActive:c})=>[O,L]),tab3:o(({title:l,value:r,isActive:c})=>[M,V,N,K,W,F]),tab4:o(({title:l,value:r,isActive:c})=>[U,e("p",null,[n("Then open the browser and finally authorize it through the following format, which are"),t(a,{text:"tenant ID",type:"info",vertical:"middle"}),t(a,{text:"client ID",type:"info",vertical:"middle"}),t(a,{text:"Callback URL",type:"info",vertical:"middle"}),n("Change to your own final login to receive")]),Y,H,Q,q,G]),_:1}),X,j,Z,t(d,{bvid:"BV1Ro4y1s725",ratio:"16:9","low-quality":"","no-danmaku":""}),J,$,e("p",null,[e("strong",null,[e("a",ee,[n("https://admin.microsoft.com/Adminportal/Home?source=applauncher#/users"),t(s)])])]),ne,te,ae,e("p",null,[n("because you didn't do it in step "),se,n(),t(a,{text:"grant xxx administrator consent",type:"info",vertical:"middle"}),n(" caused by,Pay attention to the tips below the fourth step")]),oe,e("p",null,[n("software used："),e("strong",null,[e("a",ie,[n("https://github.com/yzbtdiy/alist_batch"),t(s)])])]),e("p",null,[n("Tutorial video: "),e("strong",null,[e("a",le,[n("BV1vc411V78S"),t(s)])])]),re,t(h,{id:"mermaid-218",code:"eJydkE1vwjAMhu/8CguutKztAC3SNmniuNO0aYeKQz6cJSJtuiSlVOLHr7QFscMkNF8S2+/zynYURZOgg0ECn0pzBcI2pbFUQIFBWQHaQ+1RAGtBoKS1Cc+TEySNbbiiLsD7ywS68KE1CDQBqY0hM8bk3Adnd0hmcrUa/1GjRVAkrQ5zbo11XU/KazwdcSnXy/Xy4pBl2W+H++owYDX7crRSoAUmkMO2r9Kkf7AUY5pnd+mWEOJtgdxQ7x+7OI4LHWmadzs6wO9aVwWWYXDphRuUcKHOwz2sBkGSG8upgcrZQ7uNYmoCupIGvcc4evrDliX55nzkHoSPt9dbYW40352uPI3jhXCd1vkFt0Vhy1iFwswaZILuo8p2wnZ6xbB/MPxm5gdtZr9x"})])}const me=A(D,[["render",ce],["__file","onedrive_app.html.vue"]]);export{me as default};
