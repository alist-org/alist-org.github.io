import{_ as m,a as _,b as f,c as g,d as v,e as b,f as w,g as y,h as A,i as k}from"./onedrive_app_user-d7abb45b.js";import{_ as x,N as z,a9 as I,Q as e,W as t,a1 as i,P as n,ag as d,G as a}from"./framework-95cb4087.js";const D={},T=d('<h1 id="onedrive-app" tabindex="-1"><a class="header-anchor" href="#onedrive-app" aria-hidden="true">#</a> OneDrive APP</h1><h2 id="benefits-and-precautions" tabindex="-1"><a class="header-anchor" href="#benefits-and-precautions" aria-hidden="true">#</a> Benefits and Precautions</h2><ol><li><p>The advantage is that the administrator is only authorized to log in once, and the same is used when adding parameters later. When adding, everything is the same except for the mailbox.</p><ul><li>For example, E5 has 25 5T accounts. After you log in and initialize in advance, you can directly use the parameters before the CV. You don’t have to get the refresh token every time as before, and it will expire after a long time</li><li>A1, A1P, etc. can distribute more accounts (500 - <strong>unlimited</strong>)</li></ul></li><li><p>After the administrator authorizes in this way, he can view the account of each member in the organization at will, which will leak his own files</p><ul><li>It is recommended to apply for OneDrive E5 to get better</li></ul></li></ol><hr><p>First log in with your personal or organizational account</p>',5),B={href:"https://entra.microsoft.com/#view/Microsoft_AAD_IAM/TenantOverview.ReactView?Microsoft_AAD_IAM_legacyAADRedirect=true",target:"_blank",rel:"noopener noreferrer"},C=d('<p><img src="'+m+'" alt="onedriveapp"></p><h2 id="create-process" tabindex="-1"><a class="header-anchor" href="#create-process" aria-hidden="true">#</a> Create process</h2><div class="hint-container tip"><p class="hint-container-title">Tips</p><p>Please read carefully the following <strong><code>serial numbers , are added in sequence</code></strong>, if there is any error, please feedback in time</p></div>',3),P=e("li",null,[e("p",null,"Register an application, choose the type yourself, it is recommended to choose the third")],-1),M={href:"https://entra.microsoft.com/TokenAuthorize",target:"_blank",rel:"noopener noreferrer"},O=e("p",null,[e("img",{src:_,alt:"onedriveapp"})],-1),R=e("p",null,[e("img",{src:f,alt:"onedriveapp"})],-1),E=e("p",null,[t("Once you have obtained the client secret key, go to authorize the "),e("strong",null,[e("code",null,"API")]),t(" to be used, and follow the picture below to get it")],-1),V=e("p",null,[e("img",{src:g,alt:"onedriveapp"})],-1),L=e("p",null,"After the API is authorized, we go to authorize the organization application",-1),S=e("ul",null,[e("li",null,[t("Left sidebar ---> Enterprise applications ---> All applications ---> "),e("strong",null,"{choose which application name we started to create}"),t(" ---> Permissions ---> Click for "),e("code",null,"xxxx "),t("Grant admin consent")])],-1),F=e("p",null,[e("img",{src:v,alt:"onedriveapp"})],-1),N=e("p",null,"matters needing attention",-1),Q=e("ul",null,[e("li",null,"If you start to register the application, the callback parameters are not the same, you may get an error when you click Authorization, remember to write the same"),e("li",null,[t("How to check whether the authorization is successful. If it is not authorized, the page will prompt "),e("code",null,"The application has not been found to have the authorization of the administrator's permission"),t(". After the authorization is successful, refresh the page and you will see three API permissions, as shown in the figure below "),e("ul",null,[e("li",null,"The above is what it looks like when it is not authorized, and the following is what it looks like after authorization (just refresh the page after authorization)")])])],-1),U=e("p",null,[e("img",{src:b,alt:"onedriveapp"})],-1),W=e("p",null,[t("From the beginning to the present, we have obtained the following parameters: tenant ID"),e("sup",null,"1"),t(", registered application"),e("sup",null,"2"),t(", client ID/secret key"),e("sup",null,"3"),t(", authorization API/administrator API"),e("sup",null,"4")],-1),H=e("div",{class:"language-html line-numbers-mode","data-ext":"html"},[e("pre",{class:"language-html"},[e("code",null,`https://login.microsoftonline.com/{tenant ID or common}/adminConsent?client_id={client ID}&redirect_uri={Callback URL}
`)]),e("div",{class:"line-numbers","aria-hidden":"true"},[e("div",{class:"line-number"})])],-1),Y=e("p",null,[e("img",{src:w,alt:"onedriveapp"})],-1),G=e("p",null,"If you log in according to the spelled link and find that you are redirected to a blank page, such as the sample code and picture below, the authorization is successful, don’t worry",-1),K=e("div",{class:"language-text line-numbers-mode","data-ext":"text"},[e("pre",{class:"language-text"},[e("code",null,`https://entra.microsoft.com/TokenAuthorize?admin_consent=True&tenant={Tenant ID}#
`)]),e("div",{class:"line-numbers","aria-hidden":"true"},[e("div",{class:"line-number"})])],-1),X=e("p",null,[e("img",{src:y,alt:"onedriveapp"})],-1),j=e("h2",{id:"fill-in-the-example",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#fill-in-the-example","aria-hidden":"true"},"#"),t(" Fill in the example")],-1),Z=e("p",null,[t("Fill in the values obtained in the above process one by one. If you don’t know which email address it is, you can find it by "),e("a",{href:"#view-all-users-of-the-organization"},[e("strong",null,"view all users of the organization")])],-1),J=e("p",null,[e("img",{src:A,alt:"onedriveapp"})],-1),q=e("h2",{id:"view-all-users-of-the-organization",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#view-all-users-of-the-organization","aria-hidden":"true"},"#"),t(" View all users of the organization")],-1),$=e("p",null,[t("If you don't know how many users there are in your OneDrive organization, you can go to the link below to log in to the "),e("code",null,"admin"),t(" account to view")],-1),ee={href:"https://admin.microsoft.com/Adminportal/Home?source=applauncher#/users",target:"_blank",rel:"noopener noreferrer"},te=e("p",null,[e("img",{src:k,alt:"onedriveapp"})],-1),ie=e("h2",{id:"error-message",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#error-message","aria-hidden":"true"},"#"),t(" Error message")],-1),oe=e("ul",null,[e("li",null,[t("Tips："),e("strong",null,"Either scp or roles claim need to be present in the token"),t(" Error")])],-1),ne=e("code",null,"4",-1),ae=e("h3",{id:"the-default-download-method-used",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#the-default-download-method-used","aria-hidden":"true"},"#"),t(" The default download method used")],-1);function re(le,se){const c=a("ExternalLinkIcon"),o=a("Badge"),h=a("Tabs"),u=a("BiliBili"),p=a("Mermaid");return z(),I("div",null,[T,e("p",null,[e("strong",null,[e("a",B,[t("https://entra.microsoft.com/#view/Microsoft_AAD_IAM/TenantOverview.ReactView?Microsoft_AAD_IAM_legacyAADRedirect=true"),i(c)])])]),e("p",null,[t("Login to get our"),i(o,{text:"tenant ID",type:"info",vertical:"middle"})]),C,i(h,{id:"58",data:[{title:"1"},{title:"2"},{title:"3"},{title:"4"},{title:"5"}],"tab-id":"onedrive_app"},{tab0:n(({title:r,value:l,isActive:s})=>[e("ol",null,[P,e("li",null,[e("p",null,[t("Redirect URL (callback parameter), select Web as the type, and fill in the parameters "),e("strong",null,[e("a",M,[t("https://entra.microsoft.com/TokenAuthorize"),i(c)])]),t(" ,Otherwise, it will not be able to authorize later")])]),e("li",null,[e("p",null,[t("After filling out, click on the registration below and you can see it after jumping"),i(o,{text:"client ID",type:"info",vertical:"middle"})])])]),O]),tab1:n(({title:r,value:l,isActive:s})=>[e("p",null,[t("Let's get a client secret key, just get it as shown in the figure below, remember"),i(o,{text:"secret key",type:"info",vertical:"middle"}),t("save in time, it will only appear once")]),R]),tab2:n(({title:r,value:l,isActive:s})=>[E,V]),tab3:n(({title:r,value:l,isActive:s})=>[L,S,F,N,Q,U]),tab4:n(({title:r,value:l,isActive:s})=>[W,e("p",null,[t("Then open the browser and finally authorize it through the following format, which are"),i(o,{text:"tenant ID",type:"info",vertical:"middle"}),i(o,{text:"client ID",type:"info",vertical:"middle"}),i(o,{text:"Callback URL",type:"info",vertical:"middle"}),t("Change to your own final login to receive")]),H,Y,G,K,X]),_:1}),j,Z,J,i(u,{bvid:"BV1Ro4y1s725",ratio:"16:9","low-quality":"","no-danmaku":""}),q,$,e("p",null,[e("strong",null,[e("a",ee,[t("https://admin.microsoft.com/Adminportal/Home?source=applauncher#/users"),i(c)])])]),te,ie,oe,e("p",null,[t("because you didn't do it in step "),ne,t(),i(o,{text:"grant xxx administrator consent",type:"info",vertical:"middle"}),t(" caused by,Pay attention to the tips below the fourth step")]),ae,i(p,{id:"mermaid-196",code:"eJydkE1vwjAMhu/8CguutKztAC3SNmniuNO0aYeKQz6cJSJtuiSlVOLHr7QFscMkNF8S2+/zynYURZOgg0ECn0pzBcI2pbFUQIFBWQHaQ+1RAGtBoKS1Cc+TEySNbbiiLsD7ywS68KE1CDQBqY0hM8bk3Adnd0hmcrUa/1GjRVAkrQ5zbo11XU/KazwdcSnXy/Xy4pBl2W+H++owYDX7crRSoAUmkMO2r9Kkf7AUY5pnd+mWEOJtgdxQ7x+7OI4LHWmadzs6wO9aVwWWYXDphRuUcKHOwz2sBkGSG8upgcrZQ7uNYmoCupIGvcc4evrDliX55nzkHoSPt9dbYW40352uPI3jhXCd1vkFt0Vhy1iFwswaZILuo8p2wnZ6xbB/MPxm5gdtZr9x"})])}const he=x(D,[["render",re],["__file","onedrive_app.html.vue"]]);export{he as default};
